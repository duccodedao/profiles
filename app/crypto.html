<!DOCTYPE html>
<html lang="vi" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Elite Academy | Premium Profile</title>
    
    <!-- 1. TH∆Ø VI·ªÜN UI -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

    <!-- 2. CONFIG TAILWIND -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'], display: ['Space Grotesk', 'sans-serif'] },
                    colors: {
                        dark: { bg: '#020204', card: '#0F0F16' },
                        brand: { primary: '#6366f1', secondary: '#a855f7', accent: '#06b6d4', gold: '#fbbf24' }
                    },
                    animation: { 'blob': 'blob 7s infinite', 'spin-slow': 'spin 12s linear infinite' },
                    keyframes: {
                        blob: {
                            '0%': { transform: 'translate(0px, 0px) scale(1)' },
                            '33%': { transform: 'translate(30px, -50px) scale(1.1)' },
                            '66%': { transform: 'translate(-20px, 20px) scale(0.9)' },
                            '100%': { transform: 'translate(0px, 0px) scale(1)' }
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #020204; color: #ffffff; overflow-x: hidden; }
        .bg-mesh {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: -1; overflow: hidden;
        }
        .blob { position: absolute; filter: blur(80px); opacity: 0.4; animation: blob 10s infinite ease-in-out; border-radius: 50%; }
        .glass-panel { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.08); box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1); }
        .glass-card {
            background: linear-gradient(145deg, rgba(255,255,255,0.06) 0%, rgba(255,255,255,0.01) 100%);
            backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.05); transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .glass-card:hover { transform: translateY(-8px); border-color: rgba(99, 102, 241, 0.4); box-shadow: 0 10px 40px -10px rgba(99, 102, 241, 0.3); }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #050505; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }
        .loader { width: 48px; height: 48px; border: 5px solid #FFF; border-bottom-color: #6366f1; border-radius: 50%; display: inline-block; animation: rotation 1s linear infinite; }
        @keyframes rotation { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .input-dark { @apply w-full bg-black/50 border border-white/10 p-3 rounded-lg text-white focus:border-brand-primary focus:ring-1 focus:ring-brand-primary outline-none transition; }
        .adm-btn.active { @apply bg-brand-primary text-white font-bold shadow-lg shadow-brand-primary/20; }
    </style>
</head>
<body class="antialiased font-sans selection:bg-brand-primary selection:text-white">

    <!-- Background Effects -->
    <div class="bg-mesh">
        <div class="blob bg-brand-primary w-96 h-96 top-0 left-[-100px]"></div>
        <div class="blob bg-brand-secondary w-96 h-96 bottom-0 right-[-100px] animation-delay-2000"></div>
        <div class="blob bg-brand-accent w-64 h-64 top-[40%] left-[40%] animation-delay-4000"></div>
    </div>

    <!-- === HEADER === -->
    <nav class="fixed top-0 w-full z-50 backdrop-blur-xl border-b border-white/5 bg-black/20">
        <div class="max-w-7xl mx-auto px-4 h-20 flex items-center justify-between">
            <a href="#" class="font-display font-bold text-2xl flex items-center gap-2 group">
                <div class="w-10 h-10 rounded-full bg-gradient-to-tr from-brand-primary to-brand-secondary flex items-center justify-center text-white shadow-lg group-hover:rotate-12 transition">
                    <i class="fa-brands fa-bitcoin text-xl"></i>
                </div>
                <span class="text-white tracking-tight">CRYPTO<span class="text-brand-primary">ACADEMY</span></span>
            </a>

            <div class="flex items-center gap-4">
                <div id="userSection" class="hidden flex items-center gap-3 pl-4 pr-1 py-1 rounded-full border border-white/10 bg-white/5 backdrop-blur-md">
                    <button onclick="openMyOrders()" class="hidden md:block text-sm font-semibold hover:text-brand-primary transition px-2">Dashboard</button>
                    <div class="h-4 w-[1px] bg-white/20 hidden md:block"></div>
                    <img id="imgUser" src="" class="w-8 h-8 rounded-full object-cover ring-2 ring-brand-primary/50">
                    <button id="btnLogout" class="w-8 h-8 rounded-full bg-white/10 hover:bg-red-500/20 hover:text-red-500 flex items-center justify-center transition ml-1"><i class="fa-solid fa-power-off text-xs"></i></button>
                </div>
                <button id="btnLogin" class="hidden px-6 py-2.5 font-bold text-sm text-white bg-gradient-to-r from-brand-primary to-brand-secondary rounded-full hover:shadow-[0_0_20px_rgba(99,102,241,0.5)] transition transform hover:-translate-y-0.5">ƒêƒÉng nh·∫≠p</button>
            </div>
        </div>
    </nav>

    <!-- === MAIN CONTENT === -->
    <main class="relative z-10 pt-32 pb-20 px-4 max-w-6xl mx-auto space-y-24">

        <!-- PROFILE -->
        <section id="profileSection" class="text-center relative" data-aos="fade-up">
            <div id="profileLoader" class="loader mt-10"></div>
            <div id="profileContent" class="hidden relative z-10">
                <div class="relative w-36 h-36 md:w-44 md:h-44 mx-auto mb-8 group">
                    <div class="absolute inset-0 bg-gradient-to-r from-brand-primary to-brand-secondary rounded-full blur opacity-50 group-hover:opacity-75 transition duration-500"></div>
                    <img id="pAvatar" src="https://ui-avatars.com/api/?name=User&background=random" class="relative w-full h-full rounded-full object-cover border-4 border-dark-bg p-1 bg-dark-card">
                    <i id="pVerified" class="hidden fa-solid fa-circle-check text-blue-500 text-2xl absolute bottom-3 right-3 bg-white rounded-full border-4 border-dark-bg z-20"></i>
                </div>
                <h1 class="font-display text-5xl md:text-7xl font-bold mb-6 tracking-tight"><span id="pName" class="bg-clip-text text-transparent bg-gradient-to-r from-white via-gray-200 to-gray-400">Loading...</span></h1>
                <p id="pBio" class="text-gray-400 text-lg md:text-xl max-w-2xl mx-auto font-light leading-relaxed"></p>
                
                <!-- SOCIAL LINKS -->
                <div id="socialSection" class="flex flex-wrap justify-center gap-4 mt-8"></div>
            </div>
        </section>

        <!-- COURSES -->
        <section class="relative" data-aos="fade-up">
            <div class="flex items-end justify-between mb-10 px-2">
                <div>
                    <h2 class="font-display text-3xl md:text-4xl font-bold text-white mb-2">üî• Kh√≥a H·ªçc Premium</h2>
                    <p class="text-gray-400 text-sm">Ki·∫øn th·ª©c th·ª±c chi·∫øn t·ª´ c∆° b·∫£n ƒë·∫øn n√¢ng cao</p>
                </div>
                <div class="flex gap-2">
                    <button onclick="scrollCourses('left')" class="w-12 h-12 rounded-full border border-white/10 hover:bg-brand-primary hover:border-brand-primary text-white flex items-center justify-center transition"><i class="fa-solid fa-arrow-left"></i></button>
                    <button onclick="scrollCourses('right')" class="w-12 h-12 rounded-full border border-white/10 hover:bg-brand-primary hover:border-brand-primary text-white flex items-center justify-center transition"><i class="fa-solid fa-arrow-right"></i></button>
                </div>
            </div>
            
            <div id="coursesList" class="flex overflow-x-auto gap-6 pb-12 hide-scrollbar snap-x snap-mandatory scroll-smooth px-2"></div>
        </section>

        <!-- PARTNERS & REF -->
        <section data-aos="fade-up">
            <div class="glass-panel rounded-3xl p-8 md:p-12 relative overflow-hidden">
                <div class="absolute top-0 right-0 w-64 h-64 bg-brand-primary/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"></div>
                
                <div class="text-center mb-12 relative z-10">
                    <h2 class="font-display text-3xl font-bold text-white mb-3">ƒê·ªëi T√°c Ho√†n Ph√≠ Giao D·ªãch</h2>
                    <p class="text-gray-400">ƒêƒÉng k√Ω qua link b√™n d∆∞·ªõi v√† nh·∫≠p UID ƒë·ªÉ nh·∫≠n ho√†n ph√≠ (Backcom) tr·ªçn ƒë·ªùi.</p>
                </div>
                
                <div id="exchangeList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 relative z-10"></div>
            </div>
        </section>

    </main>

    <!-- === MODALS === -->

    <!-- 1. CHECKOUT MODAL -->
    <div id="checkoutModal" class="fixed inset-0 z-[60] hidden flex items-center justify-center p-4 bg-black/90 backdrop-blur-md transition-opacity duration-300">
        <div class="glass-panel w-full max-w-3xl rounded-3xl overflow-hidden flex flex-col md:flex-row shadow-2xl shadow-brand-primary/10 max-h-[90vh]">
            <div class="p-8 md:w-5/12 bg-gradient-to-br from-brand-primary/10 to-purple-900/10 border-r border-white/5 flex flex-col justify-between">
                <div>
                    <h3 class="text-2xl font-display font-bold text-white mb-1">Thanh to√°n</h3>
                    <p class="text-xs text-gray-400 mb-6">Ho√†n t·∫•t ƒë·ªÉ tham gia kh√≥a h·ªçc</p>
                    <div class="space-y-4">
                        <div class="bg-white/5 p-4 rounded-xl border border-white/5">
                            <span class="text-xs text-gray-400 uppercase tracking-wider block mb-1">Kh√≥a h·ªçc</span>
                            <span id="chkCourse" class="text-white font-bold text-lg block leading-tight"></span>
                        </div>
                        <div class="bg-white/5 p-4 rounded-xl border border-white/5">
                            <span class="text-xs text-gray-400 uppercase tracking-wider block mb-1">H·ªçc ph√≠</span>
                            <span id="chkPrice" class="text-brand-gold font-display font-bold text-2xl block"></span>
                        </div>
                    </div>
                </div>
                <div class="mt-8">
                    <p class="text-xs text-gray-400 mb-2 font-bold uppercase">Ph∆∞∆°ng th·ª©c</p>
                    <div class="flex gap-2">
                        <button onclick="selectPayment('BANK')" id="btnMethodBank" class="flex-1 py-3 rounded-xl border transition text-sm font-bold">NH (QR)</button>
                        <button onclick="selectPayment('CRYPTO')" id="btnMethodCrypto" class="flex-1 py-3 rounded-xl border transition text-sm font-bold">USDT</button>
                    </div>
                </div>
            </div>
            <div class="p-8 md:w-7/12 flex flex-col relative bg-dark-bg/50">
                <button onclick="closeCheckout()" class="absolute top-4 right-4 w-8 h-8 rounded-full bg-white/5 hover:bg-white/10 text-gray-400 hover:text-white flex items-center justify-center transition"><i class="fa-solid fa-xmark"></i></button>
                <div id="payViewBank" class="flex-1 flex flex-col items-center justify-center text-center space-y-4">
                    <div class="p-3 bg-white rounded-2xl shadow-lg"><img id="qrImage" src="" class="w-48 h-48 object-contain"></div>
                    <div><p class="text-white font-bold text-sm">Qu√©t m√£ ƒë·ªÉ thanh to√°n</p><p class="text-xs text-gray-400 mt-1">N·ªôi dung chuy·ªÉn kho·∫£n ƒë√£ ƒë∆∞·ª£c t·∫°o t·ª± ƒë·ªông</p></div>
                </div>
                <div id="payViewCrypto" class="hidden flex-1 flex flex-col justify-center space-y-4">
                    <div><label class="text-xs text-gray-400 mb-1 block">M·∫°ng l∆∞·ªõi</label><div class="text-white font-bold text-sm bg-white/5 p-2 rounded border border-white/10">BEP20 (BSC) ho·∫∑c TRC20</div></div>
                    <div><label class="text-xs text-gray-400 mb-1 block">ƒê·ªãa ch·ªâ v√≠ USDT</label><div class="bg-black/50 p-3 rounded-lg border border-white/10 flex items-center justify-between cursor-pointer group hover:border-brand-primary/50 transition" onclick="copyToClipboard('walletAddress')"><div class="truncate text-xs font-mono text-brand-gold w-full mr-2" id="walletAddress">...</div><i class="fa-regular fa-copy text-gray-500 group-hover:text-white"></i></div></div>
                </div>
                <div class="mt-6 pt-6 border-t border-white/10">
                    <label class="text-xs text-gray-400 mb-2 block font-bold">X√°c nh·∫≠n thanh to√°n</label>
                    <div class="flex gap-3">
                        <label for="billFile" class="flex-1 h-12 border border-dashed border-gray-600 rounded-xl cursor-pointer hover:border-brand-primary hover:bg-brand-primary/5 flex items-center justify-center text-gray-400 text-sm transition overflow-hidden px-2">
                            <i class="fa-solid fa-camera mr-2"></i> <span id="fileName" class="truncate">T·∫£i ·∫£nh bill</span>
                        </label>
                        <input type="file" id="billFile" accept="image/*" class="hidden" onchange="previewBill()">
                        <button id="btnConfirmOrder" onclick="submitOrder()" class="flex-[2] bg-gradient-to-r from-green-600 to-green-500 hover:to-green-400 text-white font-bold rounded-xl shadow-lg shadow-green-500/20 disabled:opacity-50 disabled:cursor-not-allowed transition">G·ª≠i X√°c Nh·∫≠n</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 2. UID REF MODAL -->
    <div id="uidModal" class="fixed inset-0 z-[60] hidden flex items-center justify-center p-4 bg-black/90 backdrop-blur-md">
        <div class="glass-panel w-full max-w-md rounded-2xl p-6 relative">
            <button onclick="el('uidModal').classList.add('hidden')" class="absolute top-4 right-4 text-gray-400 hover:text-white"><i class="fa-solid fa-xmark"></i></button>
            <h3 class="text-xl font-bold text-white mb-1">B√°o danh UID</h3>
            <p class="text-xs text-gray-400 mb-6">S√†n: <span id="modalExchName" class="text-brand-primary font-bold"></span></p>
            <input type="hidden" id="modalExchId">
            <div class="space-y-4">
                <div>
                    <label class="text-xs text-gray-500 uppercase font-bold">UID C·ªßa b·∫°n</label>
                    <input type="text" id="inputUid" class="input-dark mt-1" placeholder="Nh·∫≠p UID s√†n c·ªßa b·∫°n...">
                </div>
                <button onclick="submitUidRef()" class="w-full bg-brand-primary hover:bg-indigo-500 text-white font-bold py-3 rounded-lg shadow-lg shadow-brand-primary/20 transition">G·ª≠i Y√™u C·∫ßu</button>
            </div>
        </div>
    </div>

    <!-- 3. MY DASHBOARD -->
    <div id="myOrdersModal" class="fixed inset-0 z-[60] hidden flex items-center justify-center p-4 bg-black/90 backdrop-blur-md">
        <div class="glass-panel w-full max-w-4xl rounded-3xl p-0 h-[85vh] flex flex-col md:flex-row overflow-hidden">
            <div class="w-full md:w-64 bg-white/5 border-r border-white/5 p-6 flex flex-col gap-2">
                <h3 class="text-xl font-bold text-white mb-6">Dashboard</h3>
                <button onclick="switchUserTab('uTab-courses')" class="text-left px-4 py-3 rounded-xl bg-brand-primary/10 text-brand-primary font-bold border border-brand-primary/20 transition u-tab-btn" data-target="uTab-courses"><i class="fa-solid fa-graduation-cap mr-2"></i> Kh√≥a h·ªçc</button>
                <button onclick="switchUserTab('uTab-refunds')" class="text-left px-4 py-3 rounded-xl hover:bg-white/5 text-gray-400 transition u-tab-btn" data-target="uTab-refunds"><i class="fa-solid fa-money-bill-transfer mr-2"></i> Y√™u c·∫ßu ho√†n ph√≠</button>
                <div class="mt-auto"><button onclick="el('myOrdersModal').classList.add('hidden')" class="w-full py-2 text-sm text-gray-500 hover:text-white">ƒê√≥ng</button></div>
            </div>
            <div class="flex-1 p-6 md:p-8 overflow-y-auto bg-dark-bg/80">
                <div id="uTab-courses" class="space-y-4"><h4 class="text-lg font-bold text-white mb-4">Kh√≥a h·ªçc c·ªßa t√¥i</h4><div id="myOrdersList" class="grid gap-3"></div></div>
                <div id="uTab-refunds" class="hidden space-y-4"><h4 class="text-lg font-bold text-white mb-4">L·ªãch s·ª≠ b√°o danh UID</h4><div id="myRefundsList" class="grid gap-3"></div></div>
            </div>
        </div>
    </div>

    <!-- ADMIN BUTTON -->
    <button id="btnOpenAdmin" class="hidden fixed bottom-6 right-6 w-14 h-14 bg-gradient-to-r from-red-600 to-red-500 text-white rounded-full shadow-[0_0_20px_rgba(220,38,38,0.5)] z-[999] hover:scale-110 transition flex items-center justify-center group">
        <i class="fa-solid fa-gear fa-xl group-hover:rotate-90 transition duration-500"></i>
    </button>

    <!-- ADMIN PANEL -->
    <div id="adminPanel" class="fixed inset-0 z-[1000] hidden bg-[#050505] transition-all duration-300 overflow-hidden flex flex-col">
        <div class="h-16 border-b border-white/10 flex items-center justify-between px-6 bg-white/5">
            <h2 class="text-xl font-display font-bold text-white flex items-center gap-2"><i class="fa-solid fa-shield-halved text-brand-primary"></i> Admin Center</h2>
            <button onclick="toggleAdminPanel()" class="w-8 h-8 rounded-full bg-white/10 hover:bg-white/20 flex items-center justify-center"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="flex-1 flex overflow-hidden">
            <div class="w-64 bg-black border-r border-white/5 flex flex-col p-4 gap-1 overflow-y-auto">
                <div class="text-xs text-gray-500 font-bold uppercase mt-2 mb-2 px-2">Qu·∫£n l√Ω</div>
                <button onclick="switchTab('tab-orders')" class="adm-btn active"><i class="fa-solid fa-cart-shopping w-6"></i> ƒê∆°n h√†ng <span id="badgeOrders" class="ml-auto bg-red-500 text-white text-[10px] px-1.5 rounded hidden">0</span></button>
                <button onclick="switchTab('tab-refunds')" class="adm-btn"><i class="fa-solid fa-rotate w-6"></i> Y√™u c·∫ßu Ref <span id="badgeRefunds" class="ml-auto bg-red-500 text-white text-[10px] px-1.5 rounded hidden">0</span></button>
                <div class="text-xs text-gray-500 font-bold uppercase mt-6 mb-2 px-2">H·ªá th·ªëng</div>
                <button onclick="switchTab('tab-courses')" class="adm-btn"><i class="fa-solid fa-layer-group w-6"></i> Kh√≥a h·ªçc</button>
                <button onclick="switchTab('tab-exchanges')" class="adm-btn"><i class="fa-solid fa-chart-line w-6"></i> ƒê·ªëi t√°c (S√†n)</button>
                <button onclick="switchTab('tab-profile')" class="adm-btn"><i class="fa-regular fa-id-card w-6"></i> H·ªì s∆° Web</button>
                <button onclick="switchTab('tab-config')" class="adm-btn"><i class="fa-solid fa-sliders w-6"></i> C·∫•u h√¨nh</button>
            </div>
            <div class="flex-1 p-8 overflow-y-auto bg-[#0a0a0a]">
                <!-- 1. ORDERS -->
                <div id="tab-orders" class="adm-sec">
                    <h3 class="text-2xl font-bold text-white mb-6">Qu·∫£n l√Ω ƒê∆°n Kh√≥a H·ªçc</h3>
                    <div class="glass-panel rounded-xl overflow-hidden"><table class="w-full text-left text-sm text-gray-400"><thead class="bg-white/5 text-white uppercase text-xs font-bold"><tr><th class="p-4">Th·ªùi gian</th><th class="p-4">User</th><th class="p-4">Kh√≥a h·ªçc</th><th class="p-4 text-right">Gi√° tr·ªã</th><th class="p-4 text-center">Bill</th><th class="p-4 text-center">Tr·∫°ng th√°i</th><th class="p-4 text-right">H√†nh ƒë·ªông</th></tr></thead><tbody id="admOrderList" class="divide-y divide-white/5"></tbody></table></div>
                </div>
                <!-- 2. REFUNDS -->
                <div id="tab-refunds" class="adm-sec hidden">
                    <h3 class="text-2xl font-bold text-white mb-6">Y√™u c·∫ßu Ho√†n Ph√≠ (Ref)</h3>
                    <div class="glass-panel rounded-xl overflow-hidden"><table class="w-full text-left text-sm text-gray-400"><thead class="bg-white/5 text-white uppercase text-xs font-bold"><tr><th class="p-4">Th·ªùi gian</th><th class="p-4">User</th><th class="p-4">S√†n</th><th class="p-4">UID B√°o danh</th><th class="p-4 text-center">Tr·∫°ng th√°i</th><th class="p-4 text-right">H√†nh ƒë·ªông</th></tr></thead><tbody id="admRefundList" class="divide-y divide-white/5"></tbody></table></div>
                </div>
                <!-- 3. COURSES -->
                <div id="tab-courses" class="adm-sec hidden">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="lg:col-span-1"><form id="formCourse" class="glass-panel p-6 rounded-xl space-y-4 sticky top-0"><h4 class="font-bold text-white">Th√™m/S·ª≠a Kh√≥a H·ªçc</h4><input id="cName" placeholder="T√™n kh√≥a h·ªçc" class="input-dark"><input id="cPrice" placeholder="Gi√° ti·ªÅn (VNƒê)" class="input-dark text-brand-gold font-bold"><input id="cGroupLink" placeholder="Link nh√≥m Telegram (Private)" class="input-dark"><textarea id="cDesc" placeholder="M√¥ t·∫£ ng·∫Øn" rows="3" class="input-dark"></textarea><textarea id="cBenefits" placeholder="Quy·ªÅn l·ª£i (c√°ch nhau d·∫•u ph·∫©y)" rows="3" class="input-dark"></textarea><button type="submit" class="w-full bg-green-600 hover:bg-green-500 text-white py-3 rounded-lg font-bold shadow-lg transition">L∆∞u Kh√≥a H·ªçc</button></form></div>
                        <div class="lg:col-span-2 space-y-4" id="admCourseList"></div>
                    </div>
                </div>
                <!-- 4. EXCHANGES -->
                <div id="tab-exchanges" class="adm-sec hidden">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="lg:col-span-1"><form id="formExchange" class="glass-panel p-6 rounded-xl space-y-4"><h4 class="font-bold text-white">Th√™m S√†n ƒê·ªëi T√°c</h4><input id="exName" placeholder="T√™n s√†n (VD: Binance)" class="input-dark"><input id="exLink" placeholder="Link Ref (https://...)" class="input-dark"><input id="exRate" placeholder="M·ª©c ho√†n (VD: 30%)" class="input-dark"><button type="submit" class="w-full bg-brand-primary hover:bg-brand-secondary text-white py-3 rounded-lg font-bold shadow-lg transition">Th√™m S√†n</button></form></div>
                        <div class="lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-4" id="admExchList"></div>
                    </div>
                </div>
                <!-- 5. CONFIG -->
                <div id="tab-config" class="adm-sec hidden max-w-2xl">
                    <h3 class="text-2xl font-bold text-white mb-6">C·∫•u h√¨nh H·ªá Th·ªëng</h3>
                    <div class="glass-panel p-6 rounded-xl space-y-6">
                        <div><h4 class="text-brand-primary font-bold mb-3 border-b border-white/10 pb-2">Th√¥ng tin Ng√¢n h√†ng (QR Code)</h4><div class="grid gap-4"><input id="cfgBankCode" placeholder="M√£ Ng√¢n h√†ng (VD: MB, VCB)" class="input-dark"><div class="grid grid-cols-2 gap-4"><input id="cfgBankNum" placeholder="S·ªë t√†i kho·∫£n" class="input-dark"><input id="cfgBankName" placeholder="T√™n ch·ªß t√†i kho·∫£n" class="input-dark"></div></div></div>
                        <div><h4 class="text-brand-primary font-bold mb-3 border-b border-white/10 pb-2">V√≠ Crypto (USDT)</h4><input id="cfgWallet" placeholder="ƒê·ªãa ch·ªâ v√≠ USDT (BEP20/TRC20)" class="input-dark font-mono text-sm"></div>
                        <button onclick="saveConfig()" class="w-full bg-brand-primary py-3 rounded-lg font-bold text-white shadow-lg hover:bg-indigo-500 transition">L∆∞u C·∫•u H√¨nh</button>
                    </div>
                </div>
                <!-- 6. PROFILE -->
                <div id="tab-profile" class="adm-sec hidden max-w-2xl">
                    <h3 class="text-2xl font-bold text-white mb-6">Th√¥ng tin Hi·ªÉn th·ªã</h3>
                    <div class="glass-panel p-6 rounded-xl space-y-4">
                        <input id="admPName" class="input-dark font-bold text-lg" placeholder="T√™n hi·ªÉn th·ªã"><textarea id="admPBio" class="input-dark" rows="4" placeholder="Ti·ªÉu s·ª≠"></textarea>
                        <div class="space-y-2"><label class="text-xs text-gray-400">M·∫°ng x√£ h·ªôi</label><div class="grid grid-cols-2 gap-4"><input id="socFb" placeholder="Link Facebook" class="input-dark text-xs"><input id="socTele" placeholder="Link Telegram" class="input-dark text-xs"><input id="socTiktok" placeholder="Link Tiktok" class="input-dark text-xs"><input id="socYt" placeholder="Link Youtube" class="input-dark text-xs"></div></div>
                        <button onclick="saveProfile()" class="w-full bg-blue-600 hover:bg-blue-500 text-white py-3 rounded-lg font-bold shadow-lg transition">C·∫≠p nh·∫≠t Profile</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SCRIPT -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <script type="module">
        const ADMIN_EMAIL = "tytvtd@gmail.com"; 

        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, collection, getDocs, addDoc, updateDoc, deleteDoc, query, orderBy, where, onSnapshot } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-storage.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCLCcgaoW9gNYhKk0c0gDWC6i5mKVTN4XE",
            authDomain: "profile-d1214.firebaseapp.com",
            projectId: "profile-d1214",
            storageBucket: "profile-d1214.firebasestorage.app",
            messagingSenderId: "914980131889",
            appId: "1:914980131889:web:72f8da15c42dbee671b110"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app);
        const provider = new GoogleAuthProvider();

        let currentUser = null;
        let globalConfig = {};

        const formatVND = (str) => { if(!str) return ''; const num = str.toString().replace(/\D/g, ''); if(!num) return ''; return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(num); };
        const getRawMoney = (str) => str ? str.toString().replace(/\D/g, '') : '0';
        const toast = (msg, type="success") => Toastify({ text: msg, duration: 3000, gravity: "top", position: "right", style: { background: type==="success"?"linear-gradient(to right, #10B981, #059669)":"linear-gradient(to right, #EF4444, #B91C1C)", borderRadius: "8px", boxShadow: "0 4px 10px rgba(0,0,0,0.3)" } }).showToast();
        const el = (id) => document.getElementById(id);
        const nl2br = (str) => str ? str.replace(/\n/g, "<br>") : "";

        // AUTH & ADMIN CHECK
        onAuthStateChanged(auth, async (user) => {
            currentUser = user;
            if (user) {
                el('btnLogin').classList.add('hidden');
                el('userSection').classList.remove('hidden');
                el('userSection').classList.add('flex');
                el('imgUser').src = user.photoURL;
                if (user.email.toLowerCase() === ADMIN_EMAIL.toLowerCase()) {
                    el('btnOpenAdmin').classList.remove('hidden');
                    listenAdminRealtime();
                }
            } else {
                el('btnLogin').classList.remove('hidden');
                el('userSection').classList.add('hidden');
                el('btnOpenAdmin').classList.add('hidden');
            }
        });
        el('btnLogin').onclick = () => signInWithPopup(auth, provider).catch(e=>toast(e.message,"error"));
        el('btnLogout').onclick = () => signOut(auth);

        async function loadSite() {
            const cfg = await getDoc(doc(db, "settings", "config"));
            if(cfg.exists()) globalConfig = cfg.data();

            const p = await getDoc(doc(db, "site_content", "profile"));
            el('profileLoader').classList.add('hidden');
            el('profileContent').classList.remove('hidden');
            
            if(p.exists()) {
                const d = p.data();
                el('pName').innerText = d.name || 'Admin';
                el('pBio').innerHTML = nl2br(d.bio) || 'Ch∆∞a c·∫≠p nh·∫≠t ti·ªÉu s·ª≠.';
                if(d.socials) renderSocials(d.socials);
                // Admin Inputs
                el('admPName').value = d.name||''; el('admPBio').value = d.bio||'';
                if(d.socials) { el('socFb').value = d.socials.fb||''; el('socTele').value = d.socials.tele||''; el('socTiktok').value = d.socials.tiktok||''; el('socYt').value = d.socials.yt||''; }
            } else { el('pName').innerText = 'Welcome'; }

            const cSnap = await getDocs(collection(db, "courses"));
            el('coursesList').innerHTML = '';
            cSnap.forEach(doc => {
                const c = doc.data();
                const isVip = getRawMoney(c.price) > 2000000;
                el('coursesList').innerHTML += `<div class="glass-card min-w-[320px] md:min-w-[380px] rounded-3xl p-8 snap-center flex flex-col justify-between group relative overflow-hidden">${isVip ? '<div class="absolute top-0 right-0 bg-brand-gold text-black text-xs font-bold px-3 py-1 rounded-bl-xl z-20"><i class="fa-solid fa-crown"></i> VIP</div>' : ''}<div class="relative z-10"><span class="text-xs font-bold tracking-widest text-brand-primary uppercase mb-2 block">PREMIUM COURSE</span><h3 class="text-2xl font-bold text-white mb-2 group-hover:text-brand-primary transition">${c.name}</h3><div class="text-3xl font-display font-bold text-white mb-4">${c.price}</div><p class="text-gray-400 text-sm mb-6 line-clamp-3 h-14">${c.desc||''}</p><div class="space-y-3 mb-8">${(c.benefits||'').split(',').map(b=>`<div class="flex items-center gap-3 text-sm text-gray-300"><div class="w-5 h-5 rounded-full bg-brand-primary/20 flex items-center justify-center text-brand-primary text-xs"><i class="fa-solid fa-check"></i></div> ${b.trim()}</div>`).join('')}</div></div><button onclick="initCheckout('${doc.id}', '${c.name}', '${c.price}')" class="relative z-10 w-full py-4 rounded-xl bg-gradient-to-r from-brand-primary to-blue-600 text-white font-bold hover:shadow-lg hover:shadow-brand-primary/40 transition transform active:scale-95">ƒêƒÉng K√Ω Ngay</button></div>`;
            });

            const eSnap = await getDocs(collection(db, "exchanges"));
            el('exchangeList').innerHTML = '';
            eSnap.forEach(doc => {
                 const e = doc.data();
                 el('exchangeList').innerHTML += `<div class="bg-white/5 border border-white/5 p-6 rounded-2xl hover:bg-white/10 transition group flex flex-col"><div class="flex items-center gap-4 mb-4"><div class="w-12 h-12 rounded-xl bg-gradient-to-br from-white to-gray-400 flex items-center justify-center font-bold text-black text-xl shadow-lg">${e.name.substring(0,1)}</div><div><h4 class="font-bold text-white text-lg">${e.name}</h4><div class="text-xs text-brand-accent font-bold bg-brand-accent/10 px-2 py-0.5 rounded inline-block">Ho√†n ph√≠ ${e.rate}</div></div></div><div class="mt-auto grid grid-cols-2 gap-3"><a href="${e.link}" target="_blank" class="py-2.5 rounded-lg text-center bg-white/5 hover:bg-white/10 text-white text-xs font-bold border border-white/10 transition">ƒêƒÉng k√Ω</a><button onclick="openUidModal('${doc.id}', '${e.name}')" class="py-2.5 rounded-lg bg-brand-primary/20 hover:bg-brand-primary text-brand-primary hover:text-white border border-brand-primary/50 text-xs font-bold transition">B√°o UID</button></div></div>`;
            });
        }
        function renderSocials(s){
            const map = [{k:'fb',i:'fa-facebook-f',c:'hover:bg-[#1877F2]'},{k:'tele',i:'fa-telegram',c:'hover:bg-[#0088cc]'},{k:'tiktok',i:'fa-tiktok',c:'hover:bg-[#ff0050]'},{k:'yt',i:'fa-youtube',c:'hover:bg-[#FF0000]'}];
            el('socialSection').innerHTML = map.map(m=>s[m.k]?`<a href="${s[m.k]}" target="_blank" class="w-12 h-12 rounded-full bg-white/5 hover:scale-110 flex items-center justify-center text-white transition ${m.c} border border-white/10"><i class="fa-brands ${m.i} text-lg"></i></a>`:'').join('');
        }
        window.scrollCourses = (d) => { const c = el('coursesList'); if(c) c.scrollLeft += (d==='left'?-360:360); }

        let currentOrder = {};
        window.initCheckout = (id,name,price) => {
            if(!currentUser) return toast("Vui l√≤ng ƒëƒÉng nh·∫≠p tr∆∞·ªõc!","error");
            currentOrder = { id, name, price, method:'BANK' };
            el('chkCourse').innerText = name; el('chkPrice').innerText = price;
            el('checkoutModal').classList.remove('hidden'); selectPayment('BANK');
        }
        window.selectPayment = (m) => {
            currentOrder.method = m;
            const bB=el('btnMethodBank'), bC=el('btnMethodCrypto'), vB=el('payViewBank'), vC=el('payViewCrypto');
            if(m==='BANK'){
                bB.classList.add('bg-brand-primary/20','border-brand-primary','text-brand-primary'); bB.classList.remove('text-gray-400','border-white/10','hover:bg-white/5');
                bC.classList.remove('bg-brand-primary/20','border-brand-primary','text-brand-primary'); bC.classList.add('text-gray-400','border-white/10','hover:bg-white/5');
                vB.classList.remove('hidden'); vC.classList.add('hidden');
                const amt = getRawMoney(currentOrder.price);
                const content = `P${getRawMoney(currentOrder.price)} ${currentUser.email.split('@')[0]}`;
                el('qrImage').src = `https://img.vietqr.io/image/${globalConfig.bankCode||'MB'}-${globalConfig.bankNum||'0000'}-compact.jpg?amount=${amt}&addInfo=${encodeURIComponent(content)}&accountName=${encodeURIComponent(globalConfig.bankName||'ADMIN')}`;
            } else {
                bC.classList.add('bg-brand-primary/20','border-brand-primary','text-brand-primary'); bC.classList.remove('text-gray-400','border-white/10','hover:bg-white/5');
                bB.classList.remove('bg-brand-primary/20','border-brand-primary','text-brand-primary'); bB.classList.add('text-gray-400','border-white/10','hover:bg-white/5');
                vB.classList.add('hidden'); vC.classList.remove('hidden');
                el('walletAddress').innerText = globalConfig.wallet || 'Vui l√≤ng li√™n h·ªá Admin';
            }
        }
        window.submitOrder = async() => {
            const f = el('billFile').files[0]; if(!f) return toast("B·∫°n ch∆∞a t·∫£i ·∫£nh Bill l√™n!","error");
            const btn=el('btnConfirmOrder'); btn.disabled=true; btn.innerText="ƒêang t·∫£i...";
            try {
                const storageRef = ref(storage, `bills/${Date.now()}_${currentUser.uid}`);
                await uploadBytes(storageRef, f);
                const downloadURL = await getDownloadURL(storageRef);
                await addDoc(collection(db,"orders"), { uid:currentUser.uid, email:currentUser.email, courseName:currentOrder.name, courseId:currentOrder.id, price:currentOrder.price, billUrl:downloadURL, status:'pending', createdAt:new Date().toISOString() });
                toast("G·ª≠i th√†nh c√¥ng! Vui l√≤ng ch·ªù duy·ªát."); closeCheckout();
            } catch(e){ console.error(e); toast("L·ªói: " + e.message, "error"); } finally { btn.disabled=false; btn.innerText="G·ª≠i X√°c Nh·∫≠n"; }
        }

        window.openUidModal = (exId, exName) => { if(!currentUser) return toast("Vui l√≤ng ƒëƒÉng nh·∫≠p!","error"); el('modalExchName').innerText = exName; el('modalExchId').value = exId; el('inputUid').value = ''; el('uidModal').classList.remove('hidden'); }
        window.submitUidRef = async () => {
            const uid = el('inputUid').value; if(!uid) return toast("Ch∆∞a nh·∫≠p UID!","error");
            await addDoc(collection(db, "refund_requests"), { uid: currentUser.uid, email: currentUser.email, exchangeId: el('modalExchId').value, exchangeName: el('modalExchName').innerText, partnerUid: uid, status: 'pending', createdAt: new Date().toISOString() });
            toast("ƒê√£ g·ª≠i UID!"); el('uidModal').classList.add('hidden');
        }

        window.openMyOrders = async () => { if(!currentUser) return; el('myOrdersModal').classList.remove('hidden'); switchUserTab('uTab-courses'); }
        window.switchUserTab = async (tabId) => {
            document.querySelectorAll('.u-tab-btn').forEach(b => { b.className = "text-left px-4 py-3 rounded-xl hover:bg-white/5 text-gray-400 transition u-tab-btn"; if(b.dataset.target === tabId) b.className = "text-left px-4 py-3 rounded-xl bg-brand-primary/10 text-brand-primary font-bold border border-brand-primary/20 transition u-tab-btn"; });
            el('uTab-courses').classList.add('hidden'); el('uTab-refunds').classList.add('hidden'); el(tabId).classList.remove('hidden');
            if(tabId === 'uTab-courses') {
                const snap = await getDocs(query(collection(db,"orders"), where("uid","==",currentUser.uid), orderBy("createdAt","desc")));
                const l = el('myOrdersList'); l.innerHTML = '';
                if(snap.empty) l.innerHTML = '<p class="text-gray-500 italic">Ch∆∞a ƒëƒÉng k√Ω kh√≥a h·ªçc n√†o.</p>';
                snap.forEach(d=>{ const o=d.data(); l.innerHTML+=`<div class="bg-black/40 p-4 rounded-xl border border-white/5 flex justify-between items-center"><div><div class="font-bold text-white text-lg">${o.courseName}</div><div class="text-xs text-gray-400">${new Date(o.createdAt).toLocaleDateString()} ‚Ä¢ ${o.price}</div></div><div class="text-right"><span class="px-2 py-1 rounded text-xs font-bold border ${o.status==='approved'?'bg-green-500/10 text-green-500 border-green-500/20':'bg-yellow-500/10 text-yellow-500 border-yellow-500/20'} block mb-2 text-center w-full uppercase">${o.status}</span>${o.status==='approved' ? `<a href="${o.groupLink||'#'}" target="_blank" class="inline-block px-3 py-1 bg-brand-primary text-white text-xs font-bold rounded hover:bg-brand-secondary transition">V√†o Nh√≥m <i class="fa-solid fa-arrow-right ml-1"></i></a>` : ''}</div></div>`; });
            } else {
                const snap = await getDocs(query(collection(db,"refund_requests"), where("uid","==",currentUser.uid), orderBy("createdAt","desc")));
                const l = el('myRefundsList'); l.innerHTML = '';
                snap.forEach(d=>{ const o=d.data(); l.innerHTML+=`<div class="bg-black/40 p-4 rounded-xl border border-white/5 flex justify-between items-center"><div><div class="font-bold text-white">${o.exchangeName}</div><div class="text-sm text-gray-400">UID: ${o.partnerUid}</div></div><div class="font-bold uppercase text-xs ${o.status==='approved'?'text-green-500':'text-yellow-500'}">${o.status}</div></div>`; });
            }
        }

        // --- ADMIN PANEL CONTROLLER ---
        if(el('btnOpenAdmin')) {
            el('btnOpenAdmin').addEventListener('click', async () => {
                const p = el('adminPanel'); p.classList.remove('hidden');
                try { await loadAdminStaticData(); } catch (e) { console.error(e); }
            });
        }
        window.toggleAdminPanel = () => { el('adminPanel').classList.add('hidden'); }
        window.switchTab = (id) => {
            document.querySelectorAll('.adm-sec').forEach(e=>e.classList.add('hidden')); el(id).classList.remove('hidden');
            document.querySelectorAll('.adm-btn').forEach(b=>b.className="adm-btn w-full text-left px-4 py-3 rounded text-gray-400 hover:bg-white/5 hover:text-white transition flex items-center");
            if(event && event.currentTarget) event.currentTarget.className="adm-btn w-full text-left px-4 py-3 rounded bg-brand-primary text-white font-bold flex items-center shadow-lg shadow-brand-primary/20";
        }

        function listenAdminRealtime() {
            try {
                onSnapshot(query(collection(db,"orders"), orderBy("createdAt","desc")), (snap) => {
                    let pendingCount = 0;
                    if(el('admOrderList')) {
                        el('admOrderList').innerHTML = snap.docs.map(d=>{
                            const o=d.data(); if(o.status==='pending') pendingCount++;
                            return `<tr class="hover:bg-white/5 transition border-b border-white/5 last:border-0"><td class="p-4 text-xs text-gray-400">${new Date(o.createdAt).toLocaleDateString()}</td><td class="p-4 font-bold text-white">${o.email}</td><td class="p-4 text-sm">${o.courseName}</td><td class="p-4 text-right font-mono text-brand-gold">${o.price}</td><td class="p-4 text-center"><a href="${o.billUrl}" target="_blank" class="text-blue-400 hover:underline text-xs"><i class="fa-solid fa-link"></i> Xem</a></td><td class="p-4 text-center"><span class="px-2 py-0.5 rounded text-[10px] font-bold uppercase ${o.status==='approved'?'bg-green-500/20 text-green-500':'bg-yellow-500/20 text-yellow-500'}">${o.status}</span></td><td class="p-4 text-right">${o.status==='pending' ? `<button onclick="approveOrder('${d.id}','${o.courseId}')" class="bg-green-600 hover:bg-green-500 text-white px-3 py-1 rounded text-xs font-bold transition">Duy·ªát</button>` : '<i class="fa-solid fa-check text-green-500"></i>'}</td></tr>`
                        }).join('');
                    }
                    if(el('badgeOrders')) { if(pendingCount > 0) { el('badgeOrders').innerText=pendingCount; el('badgeOrders').classList.remove('hidden'); } else el('badgeOrders').classList.add('hidden'); }
                });
                onSnapshot(query(collection(db,"refund_requests"), orderBy("createdAt","desc")), (snap) => {
                    let pendingCount = 0;
                    if(el('admRefundList')) {
                        el('admRefundList').innerHTML = snap.docs.map(d=>{
                            const o=d.data(); if(o.status==='pending') pendingCount++;
                            return `<tr class="hover:bg-white/5 transition border-b border-white/5 last:border-0"><td class="p-4 text-xs text-gray-400">${new Date(o.createdAt).toLocaleDateString()}</td><td class="p-4 text-white">${o.email}</td><td class="p-4 font-bold text-brand-primary">${o.exchangeName}</td><td class="p-4 font-mono">${o.partnerUid}</td><td class="p-4 text-center"><span class="px-2 py-0.5 rounded text-[10px] font-bold uppercase ${o.status==='approved'?'bg-green-500/20 text-green-500':'bg-yellow-500/20 text-yellow-500'}">${o.status}</span></td><td class="p-4 text-right">${o.status==='pending' ? `<button onclick="approveRefund('${d.id}')" class="bg-brand-primary hover:bg-brand-secondary text-white px-3 py-1 rounded text-xs font-bold transition">Duy·ªát</button>` : '<i class="fa-solid fa-check text-green-500"></i>'}</td></tr>`
                        }).join('');
                    }
                    if(el('badgeRefunds')) { if(pendingCount > 0) { el('badgeRefunds').innerText=pendingCount; el('badgeRefunds').classList.remove('hidden'); } else el('badgeRefunds').classList.add('hidden'); }
                });
            } catch(e) {}
        }

        async function loadAdminStaticData() {
            const cSnap = await getDocs(collection(db,"courses"));
            el('admCourseList').innerHTML=cSnap.docs.map(d=>`<div class="flex justify-between items-center p-4 bg-white/5 border border-white/10 rounded-lg hover:border-brand-primary/50 transition"><div><div class="font-bold text-white">${d.data().name}</div><div class="text-xs text-brand-gold">${d.data().price}</div></div><button onclick="delDoc('courses','${d.id}')" class="w-8 h-8 rounded bg-red-500/10 text-red-500 hover:bg-red-500 hover:text-white transition flex items-center justify-center"><i class="fa-solid fa-trash text-xs"></i></button></div>`).join('');
            const eSnap = await getDocs(collection(db,"exchanges"));
            el('admExchList').innerHTML=eSnap.docs.map(d=>`<div class="p-4 bg-white/5 border border-white/10 rounded-lg flex justify-between items-center"><div><div class="font-bold text-white">${d.data().name}</div><div class="text-xs text-gray-400">${d.data().rate}</div></div><button onclick="delDoc('exchanges','${d.id}')" class="w-8 h-8 rounded bg-red-500/10 text-red-500 hover:bg-red-500 hover:text-white transition flex items-center justify-center"><i class="fa-solid fa-trash text-xs"></i></button></div>`).join('');
            el('cfgBankCode').value=globalConfig.bankCode||''; el('cfgBankNum').value=globalConfig.bankNum||''; el('cfgBankName').value=globalConfig.bankName||''; el('cfgWallet').value=globalConfig.wallet||'';
        }

        window.approveOrder = async(oid, cid) => { if(!confirm("X√°c nh·∫≠n ƒë√£ nh·∫≠n ti·ªÅn?")) return; const c = await getDoc(doc(db,"courses",cid)); await updateDoc(doc(db,"orders",oid), {status:'approved', groupLink: c.exists()?c.data().groupLink:'#'}); toast("ƒê√£ duy·ªát ƒë∆°n h√†ng!"); }
        window.approveRefund = async(rid) => { await updateDoc(doc(db,"refund_requests",rid), {status:'approved'}); toast("ƒê√£ x√°c minh UID!"); }
        window.delDoc = async(c,id)=>{ if(confirm("X√≥a vƒ©nh vi·ªÖn?")){await deleteDoc(doc(db,c,id)); loadAdminStaticData(); loadSite();} }
        el('cPrice').addEventListener('input', function() { this.value = formatVND(this.value); });
        el('formCourse').addEventListener('submit', async(e)=>{ e.preventDefault(); await addDoc(collection(db,"courses"), { name: el('cName').value, price: el('cPrice').value, desc: el('cDesc').value, groupLink: el('cGroupLink').value, benefits: el('cBenefits').value }); toast("ƒê√£ th√™m kh√≥a h·ªçc!"); el('formCourse').reset(); loadAdminStaticData(); loadSite(); });
        el('formExchange').addEventListener('submit', async(e)=>{ e.preventDefault(); await addDoc(collection(db,"exchanges"),{name:el('exName').value, link:el('exLink').value, rate:el('exRate').value}); toast("ƒê√£ th√™m s√†n!"); el('formExchange').reset(); loadAdminStaticData(); loadSite(); });
        window.saveConfig = async()=>{ await setDoc(doc(db,"settings","config"),{ bankCode:el('cfgBankCode').value, bankNum:el('cfgBankNum').value, bankName:el('cfgBankName').value, wallet:el('cfgWallet').value }); toast("ƒê√£ l∆∞u c·∫•u h√¨nh!"); }
        window.saveProfile = async()=>{ await setDoc(doc(db,"site_content","profile"),{ name:el('admPName').value, bio:el('admPBio').value, socials: {fb:el('socFb').value, tele:el('socTele').value, tiktok:el('socTiktok').value, yt:el('socYt').value} }, {merge:true}); toast("ƒê√£ c·∫≠p nh·∫≠t Profile!"); loadSite(); }
        window.closeCheckout = ()=>el('checkoutModal').classList.add('hidden');
        window.previewBill = ()=>{if(el('billFile').files[0]) el('fileName').innerText=el('billFile').files[0].name;}
        window.copyToClipboard = (id)=>{navigator.clipboard.writeText(el(id).innerText); toast("ƒê√£ sao ch√©p v√≠!");}

        AOS.init({ duration: 800, once: true });
        loadSite();
    </script>
</body>
</html>
