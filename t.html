<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>HD Ecosystem Pro | Nền tảng công nghệ toàn diện 2026</title>
    
    <!-- Frameworks -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root { 
            --gold: linear-gradient(135deg, #FFD700, #B8860B);
            --dark: #0f172a;
        }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f8fafc; color: #1e293b; scroll-behavior: smooth; overflow-x: hidden; }
        
        .gold-text { background: var(--gold); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .glass-nav { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(0,0,0,0.05); }
        .bento-card { border: 1px solid rgba(0,0,0,0.05); transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1); background: white; }
        .bento-card:hover { transform: translateY(-10px); box-shadow: 0 20px 40px rgba(0,0,0,0.08); border-color: #fbbf24; }
        
        /* Loading Animation */
        #loader { position: fixed; inset: 0; background: white; z-index: 9999; display: flex; items-center; justify-content: center; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .btn-primary { 
            background: var(--dark); 
            color: white; 
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        .btn-primary:hover { transform: scale(1.02); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        
        .dashboard-card { background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); color: white; }
    </style>
</head>
<body>

    <!-- LOADER -->
    <div id="loader">
        <div class="flex flex-col items-center">
            <div class="w-12 h-12 border-4 border-yellow-500 border-t-transparent rounded-full animate-spin"></div>
            <p class="mt-4 font-bold text-gray-400 tracking-widest text-xs uppercase">HD Ecosystem Loading...</p>
        </div>
    </div>

    <!-- NAVIGATION -->
    <nav class="fixed top-0 left-0 right-0 w-full flex justify-center pt-4 px-4 z-50">
        <div class="glass-nav w-full max-w-6xl px-6 py-4 rounded-3xl flex items-center justify-between shadow-2xl shadow-black/5">
            <div class="flex items-center gap-2">
                <div class="w-10 h-10 bg-black rounded-xl flex items-center justify-center">
                    <i data-lucide="layers" class="text-yellow-500 w-6 h-6"></i>
                </div>
                <div class="flex flex-col">
                    <span class="font-extrabold tracking-tight text-lg leading-none">HD PLATFORM</span>
                    <span class="text-[10px] text-gray-400 font-bold uppercase tracking-widest">Ecosystem 2026</span>
                </div>
            </div>
            
            <div class="hidden md:flex gap-8 text-sm font-bold text-gray-600">
                <a href="#vision" class="hover:text-yellow-600 transition">Tầm nhìn</a>
                <a href="#missions" class="hover:text-yellow-600 transition">Săn $HD</a>
                <a href="#roadmap" class="hover:text-yellow-600 transition">Lộ trình</a>
            </div>

            <div id="auth-section" class="flex items-center gap-4">
                <button id="login-btn" class="btn-primary px-6 py-2.5 rounded-2xl text-xs font-bold uppercase tracking-wider">Đăng nhập</button>
                
                <div id="user-info" class="hidden flex items-center gap-3 bg-gray-100 p-1.5 pr-4 rounded-2xl border border-black/5">
                    <img id="user-photo" class="w-8 h-8 rounded-xl border-2 border-white shadow-sm">
                    <div class="flex flex-col">
                        <span id="user-name" class="text-xs font-bold leading-none">...</span>
                        <span id="user-balance-nav" class="text-[10px] font-bold text-yellow-600">0 $HD</span>
                    </div>
                    <button id="admin-trigger" class="hidden ml-2 p-1.5 bg-white rounded-lg shadow-sm hover:text-yellow-600 transition">
                        <i data-lucide="shield-check" class="w-4 h-4"></i>
                    </button>
                    <button id="logout-btn" class="ml-1 p-1.5 hover:text-red-500 transition">
                        <i data-lucide="log-out" class="w-4 h-4"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- HERO SECTION -->
    <header class="relative min-h-screen w-full flex items-center justify-center pt-20 overflow-hidden bg-white">
        <div class="absolute inset-0 z-0 opacity-40">
            <div class="absolute top-0 -left-20 w-96 h-96 bg-yellow-200 rounded-full blur-[120px]"></div>
            <div class="absolute bottom-0 -right-20 w-96 h-96 bg-blue-100 rounded-full blur-[120px]"></div>
        </div>

        <div class="relative z-10 text-center px-6 max-w-5xl">
            <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gray-100 border border-black/5 mb-8 animate-bounce">
                <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                <span class="text-[10px] font-bold uppercase tracking-widest text-gray-500">Hệ sinh thái đã sẵn sàng</span>
            </div>
            <h1 class="text-6xl md:text-[110px] font-extrabold tracking-tighter leading-[0.85] mb-8" id="cms-hero-title">
                The Next Gen <br> <span class="gold-text">Vietnam Tech</span>
            </h1>
            <p class="text-lg md:text-xl text-gray-500 max-w-2xl mx-auto mb-10 leading-relaxed" id="cms-hero-subtitle">
                Trải nghiệm nền tảng quản trị thông minh, minh bạch và tối ưu hóa hiệu suất cho cộng đồng công nghệ Việt Nam.
            </p>
            <div class="flex flex-wrap justify-center gap-4">
                <a href="#missions" class="btn-primary px-10 py-5 rounded-2xl font-bold flex items-center gap-3">
                    Bắt đầu nhiệm vụ <i data-lucide="arrow-right" class="w-5 h-5"></i>
                </a>
                <button class="px-10 py-5 rounded-2xl font-bold border border-gray-200 hover:bg-gray-50 transition">
                    Tài liệu Whitepaper
                </button>
            </div>
        </div>
    </header>

    <!-- DASHBOARD PREVIEW (REAL DATA) -->
    <section id="user-dashboard" class="py-10 px-6 hidden">
        <div class="max-w-6xl mx-auto">
            <div class="dashboard-card p-8 rounded-[40px] shadow-2xl relative overflow-hidden">
                <div class="relative z-10 grid grid-cols-1 md:grid-cols-3 gap-8 items-center">
                    <div>
                        <p class="text-gray-400 text-xs font-bold uppercase tracking-widest mb-2">Tài sản của bạn</p>
                        <h2 class="text-5xl font-black text-yellow-500"><span id="user-balance-main">0</span> <span class="text-2xl text-white opacity-50">$HD</span></h2>
                    </div>
                    <div class="flex flex-col gap-2">
                        <div class="flex justify-between text-xs font-bold uppercase">
                            <span>Cấp độ: Diamond</span>
                            <span class="text-yellow-500">85%</span>
                        </div>
                        <div class="w-full h-3 bg-white/10 rounded-full overflow-hidden">
                            <div class="h-full bg-yellow-500 w-[85%] shadow-[0_0_20px_#fbbf24]"></div>
                        </div>
                    </div>
                    <div class="flex justify-end">
                        <button onclick="dailyCheckIn()" id="checkin-btn" class="bg-white text-black px-8 py-4 rounded-2xl font-bold hover:bg-yellow-500 transition active:scale-95">
                            Điểm danh hàng ngày
                        </button>
                    </div>
                </div>
                <!-- Abstract patterns -->
                <div class="absolute top-0 right-0 w-64 h-64 bg-yellow-500/10 rounded-full -mr-20 -mt-20 blur-3xl"></div>
            </div>
        </div>
    </section>

    <!-- MISSION SECTION -->
    <section id="missions" class="py-24 px-6">
        <div class="max-w-6xl mx-auto">
            <div class="flex flex-col md:flex-row justify-between items-end mb-16 gap-6">
                <div>
                    <h2 class="text-5xl font-extrabold tracking-tight mb-4">Nhiệm vụ kiếm <span class="gold-text">$HD</span></h2>
                    <p class="text-gray-500 max-w-md">Hoàn thành các hoạt động tương tác để nhận phần thưởng Token giá trị mỗi ngày.</p>
                </div>
                <div class="flex gap-4">
                    <div class="bg-white border p-4 rounded-2xl shadow-sm text-center min-w-[120px]">
                        <p class="text-[10px] font-bold text-gray-400 uppercase">Đang lưu thông</p>
                        <p id="stat-circulation" class="text-xl font-bold">0</p>
                    </div>
                    <div class="bg-white border p-4 rounded-2xl shadow-sm text-center min-w-[120px]">
                        <p class="text-[10px] font-bold text-gray-400 uppercase">Người dùng</p>
                        <p id="stat-users" class="text-xl font-bold">0</p>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bento-card p-8 rounded-[32px] flex items-center justify-between group cursor-pointer" onclick="dailyCheckIn()">
                    <div class="flex items-center gap-6">
                        <div class="w-16 h-16 bg-yellow-50 rounded-2xl flex items-center justify-center text-yellow-600 group-hover:bg-yellow-500 group-hover:text-white transition-colors">
                            <i data-lucide="calendar-check-2" class="w-8 h-8"></i>
                        </div>
                        <div>
                            <h4 class="font-bold text-xl">Điểm danh 24h</h4>
                            <p class="text-sm text-gray-400">Nhận thưởng ngẫu nhiên từ 10-50 $HD</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <span class="block font-black text-2xl text-yellow-600">+?? $HD</span>
                        <span class="text-[10px] font-bold text-green-500 uppercase">Sẵn sàng</span>
                    </div>
                </div>

                <div class="bento-card p-8 rounded-[32px] flex items-center justify-between group opacity-60 cursor-not-allowed">
                    <div class="flex items-center gap-6">
                        <div class="w-16 h-16 bg-blue-50 rounded-2xl flex items-center justify-center text-blue-600">
                            <i data-lucide="share-2" class="w-8 h-8"></i>
                        </div>
                        <div>
                            <h4 class="font-bold text-xl">Mời bạn bè</h4>
                            <p class="text-sm text-gray-400">Nhận 100 $HD cho mỗi lượt mời</p>
                        </div>
                    </div>
                    <div class="text-right font-black text-2xl text-blue-600">
                        +100 $HD
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FOOTER -->
    <footer class="py-20 px-6 border-t border-gray-100 bg-white">
        <div class="max-w-6xl mx-auto flex flex-col md:flex-row justify-between items-center gap-8">
            <div class="flex items-center gap-2">
                <div class="w-8 h-8 bg-black rounded-lg flex items-center justify-center">
                    <i data-lucide="layers" class="text-yellow-500 w-5 h-5"></i>
                </div>
                <span class="font-bold text-xl tracking-tighter">HD Ecosystem</span>
            </div>
            <p class="text-sm text-gray-400">© 2026 HD Platform. Phát triển bởi đội ngũ kỹ sư Việt Nam.</p>
            <div class="flex gap-6">
                <a href="#" class="text-gray-400 hover:text-black"><i data-lucide="facebook"></i></a>
                <a href="#" class="text-gray-400 hover:text-black"><i data-lucide="github"></i></a>
                <a href="#" class="text-gray-400 hover:text-black"><i data-lucide="twitter"></i></a>
            </div>
        </div>
    </footer>

    <!-- ADMIN PANEL (FULL SCREEN OVERLAY) -->
    <div id="admin-panel" class="fixed inset-0 bg-[#f1f5f9] z-[100] hidden overflow-y-auto">
        <div class="max-w-7xl mx-auto p-6 md:p-12">
            <div class="flex justify-between items-center mb-12">
                <div>
                    <h2 class="text-4xl font-black tracking-tight">Hệ thống <span class="text-yellow-600">Quản trị</span></h2>
                    <p class="text-gray-500">Cấu hình CMS và Quản lý người dùng thời gian thực.</p>
                </div>
                <button id="close-admin" class="p-4 bg-white rounded-2xl shadow-sm hover:bg-red-50 hover:text-red-500 transition">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Quản lý nội dung -->
                <div class="lg:col-span-2 space-y-8">
                    <div class="bg-white p-8 rounded-[32px] shadow-sm border border-black/5">
                        <h3 class="text-xl font-bold mb-6 flex items-center gap-2">
                            <i data-lucide="edit-3" class="w-5 h-5"></i> Cấu hình Website
                        </h3>
                        <div class="grid gap-6">
                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="text-[10px] font-black uppercase text-gray-400 ml-2">Tiêu đề chính</label>
                                    <input id="edit-hero-title" type="text" class="w-full mt-1 p-4 bg-gray-50 rounded-2xl focus:ring-2 ring-yellow-500 outline-none transition">
                                </div>
                                <div>
                                    <label class="text-[10px] font-black uppercase text-gray-400 ml-2">Token Lưu thông</label>
                                    <input id="edit-circulation" type="number" class="w-full mt-1 p-4 bg-gray-50 rounded-2xl focus:ring-2 ring-yellow-500 outline-none transition">
                                </div>
                            </div>
                            <div>
                                <label class="text-[10px] font-black uppercase text-gray-400 ml-2">Mô tả Hero</label>
                                <textarea id="edit-hero-subtitle" class="w-full mt-1 p-4 bg-gray-50 rounded-2xl h-24 focus:ring-2 ring-yellow-500 outline-none transition"></textarea>
                            </div>
                            <button id="save-cms" class="w-full bg-black text-white py-5 rounded-2xl font-bold hover:bg-yellow-600 transition tracking-widest uppercase text-sm">Cập nhật hệ thống</button>
                        </div>
                    </div>

                    <div class="bg-white p-8 rounded-[32px] shadow-sm border border-black/5">
                        <h3 class="text-xl font-bold mb-6">Danh sách User mới nhất</h3>
                        <div id="user-list-admin" class="space-y-4">
                            <!-- User row placeholder -->
                        </div>
                    </div>
                </div>

                <!-- Logs & Stats -->
                <div class="space-y-8">
                    <div class="bg-black text-white p-8 rounded-[32px] shadow-xl shadow-black/10">
                        <h3 class="text-lg font-bold mb-4 opacity-60 italic">Hoạt động hệ thống</h3>
                        <div id="admin-logs" class="space-y-3 font-mono text-[10px] max-h-[400px] overflow-y-auto pr-2">
                            <!-- Logs here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- FIREBASE MODULE -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, onSnapshot, setDoc, getDoc, collection, addDoc, query, orderBy, limit, increment } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // --- Firebase Config (Dữ liệu của bạn) ---
        const firebaseConfig = {
            apiKey: "AIzaSyCLCcgaoW9gNYhKk0c0gDWC6i5mKVTN4XE",
            authDomain: "profile-d1214.firebaseapp.com",
            projectId: "profile-d1214",
            storageBucket: "profile-d1214.firebasestorage.app",
            messagingSenderId: "914980131889",
            appId: "1:914980131889:web:72f8da15c42dbee671b110",
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const provider = new GoogleAuthProvider();
        const ADMIN_UID = "VYIs9XHLR9RMStwtcdwMrOIo33w1";

        // --- Khởi tạo UI ---
        lucide.createIcons();
        window.addEventListener('load', () => {
            gsap.to("#loader", { opacity: 0, duration: 0.5, onComplete: () => document.getElementById('loader').style.display = 'none' });
        });

        // --- Quản trị xác thực ---
        onAuthStateChanged(auth, async (user) => {
            const loginBtn = document.getElementById('login-btn');
            const userInfo = document.getElementById('user-info');
            const dashArea = document.getElementById('user-dashboard');

            if (user) {
                loginBtn.classList.add('hidden');
                userInfo.classList.remove('hidden');
                dashArea.classList.remove('hidden');
                
                document.getElementById('user-photo').src = user.photoURL;
                document.getElementById('user-name').innerText = user.displayName.split(' ').pop();
                
                if (user.uid === ADMIN_UID) {
                    document.getElementById('admin-trigger').classList.remove('hidden');
                    loadAdminData();
                }

                // Đồng bộ Profile & Balance
                syncUserProfile(user);
            } else {
                loginBtn.classList.remove('hidden');
                userInfo.classList.add('hidden');
                dashArea.classList.add('hidden');
            }
        });

        // Đăng nhập / Đăng xuất
        document.getElementById('login-btn').onclick = () => signInWithPopup(auth, provider);
        document.getElementById('logout-btn').onclick = () => signOut(auth);
        document.getElementById('admin-trigger').onclick = () => document.getElementById('admin-panel').style.display = 'block';
        document.getElementById('close-admin').onclick = () => document.getElementById('admin-panel').style.display = 'none';

        // --- Logic: Đồng bộ Người dùng ---
        async function syncUserProfile(user) {
            const userRef = doc(db, "users", user.uid);
            onSnapshot(userRef, (snap) => {
                if (snap.exists()) {
                    const data = snap.data();
                    const bal = data.balance || 0;
                    document.getElementById('user-balance-nav').innerText = `${bal.toLocaleString()} $HD`;
                    document.getElementById('user-balance-main').innerText = bal.toLocaleString();
                } else {
                    setDoc(userRef, { name: user.displayName, email: user.email, balance: 0, lastCheckin: 0 });
                }
            });
        }

        // --- Logic: Nhiệm vụ Điểm danh (Daily Check-in) ---
        window.dailyCheckIn = async () => {
            const user = auth.currentUser;
            if (!user) return Swal.fire("Thông báo", "Vui lòng đăng nhập!", "warning");

            const userRef = doc(db, "users", user.uid);
            const userSnap = await getDoc(userRef);
            const userData = userSnap.data();

            const now = Date.now();
            const oneDay = 24 * 60 * 60 * 1000;

            if (userData.lastCheckin && (now - userData.lastCheckin < oneDay)) {
                const timeLeft = Math.ceil((oneDay - (now - userData.lastCheckin)) / (60 * 60 * 1000));
                return Swal.fire("Chưa thể điểm danh", `Bạn cần đợi thêm ${timeLeft} giờ nữa.`, "info");
            }

            const reward = Math.floor(Math.random() * 41) + 10; // 10-50 $HD
            await setDoc(userRef, {
                balance: increment(reward),
                lastCheckin: now
            }, { merge: true });

            addLog(`${user.displayName} nhận thưởng điểm danh: +${reward} $HD`);
            Swal.fire("Thành công!", `Bạn đã nhận được ${reward} $HD vào tài khoản.`, "success");
        };

        // --- CMS REAL-TIME ---
        onSnapshot(doc(db, "settings", "content"), (snap) => {
            if (snap.exists()) {
                const data = snap.data();
                document.getElementById('cms-hero-title').innerHTML = data.heroTitle || 'The Next Gen <br> <span class="gold-text">Vietnam Tech</span>';
                document.getElementById('cms-hero-subtitle').innerText = data.heroSubtitle || '...';
                
                animateValue("stat-circulation", 0, data.statCirculation || 5000000, 1500);
                animateValue("stat-users", 0, data.statUsers || 1200, 1500);

                // Admin Inputs
                document.getElementById('edit-hero-title').value = data.heroTitle || '';
                document.getElementById('edit-hero-subtitle').value = data.heroSubtitle || '';
                document.getElementById('edit-circulation').value = data.statCirculation || 0;
            }
        });

        // Lưu CMS
        document.getElementById('save-cms').onclick = async () => {
            try {
                await setDoc(doc(db, "settings", "content"), {
                    heroTitle: document.getElementById('edit-hero-title').value,
                    heroSubtitle: document.getElementById('edit-hero-subtitle').value,
                    statCirculation: parseInt(document.getElementById('edit-circulation').value),
                    statUsers: parseInt(document.getElementById('stat-users').innerText.replace(/,/g, ''))
                }, { merge: true });
                addLog("Admin cập nhật cấu hình hệ thống");
                Swal.fire("Đã cập nhật!", "Thay đổi đã được áp dụng toàn hệ thống.", "success");
            } catch (e) { Swal.fire("Lỗi", "Bạn không có quyền quản trị!", "error"); }
        };

        // --- ADMIN UTILS ---
        function loadAdminData() {
            // Tải Logs
            onSnapshot(query(collection(db, "logs"), orderBy("timestamp", "desc"), limit(20)), (snap) => {
                const logsContainer = document.getElementById('admin-logs');
                logsContainer.innerHTML = snap.docs.map(doc => {
                    const l = doc.data();
                    const time = l.timestamp?.toDate().toLocaleTimeString() || 'Vừa xong';
                    return `<div class="p-2 border-b border-white/10 hover:bg-white/5 transition">
                        <span class="text-yellow-500 font-bold">[${time}]</span> ${l.action}
                    </div>`;
                }).join('');
            });

            // Tải Danh sách Users
            onSnapshot(query(collection(db, "users"), limit(5)), (snap) => {
                const userList = document.getElementById('user-list-admin');
                userList.innerHTML = snap.docs.map(doc => {
                    const u = doc.data();
                    return `<div class="flex items-center justify-between p-4 bg-gray-50 rounded-2xl">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 bg-yellow-500 rounded-full flex items-center justify-center font-bold text-white">${u.name.charAt(0)}</div>
                            <div>
                                <p class="text-sm font-bold">${u.name}</p>
                                <p class="text-[10px] text-gray-400">${u.email}</p>
                            </div>
                        </div>
                        <span class="font-bold text-yellow-600">${(u.balance || 0).toLocaleString()} $HD</span>
                    </div>`;
                }).join('');
            });
        }

        async function addLog(action) {
            await addDoc(collection(db, "logs"), { action, timestamp: new Date() });
        }

        function animateValue(id, start, end, duration) {
            const obj = document.getElementById(id);
            if (!obj) return;
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const val = Math.floor(progress * (end - start) + start);
                obj.innerText = val.toLocaleString();
                if (progress < 1) window.requestAnimationFrame(step);
            };
            window.requestAnimationFrame(step);
        }

        // --- Hiệu ứng cuộn (Scroll Reveal) ---
        gsap.registerPlugin(ScrollTrigger);
        document.querySelectorAll('.bento-card').forEach(card => {
            gsap.from(card, {
                scrollTrigger: { trigger: card, start: "top 90%" },
                opacity: 0,
                y: 50,
                duration: 0.8,
                ease: "power2.out"
            });
        });

    </script>
</body>
</html>
